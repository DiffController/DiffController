# DiffController : A Differential Testing Framework for SDN Controllers

DiffController is a differential testing framework to automatically identify bugs in the SDN controllers. Now, DiffController1 can be applied to 4 popular open-
source SDN controllers(i.e., Floodlight, ONOS, Ryu, and OpenDaylight). 
DiffController defines strategy that operate on the sequence of packets sent to the controller from the data plane. Further, Diffcontroller collects and compares the output of different controllers to discover some strategies that can lead to differences in controller behavior. Eventually manually confirm if these policies can cause bugs in the controller.

## Project Overview

DiffController consists of 5 key components:the Strategy Generator and the Strategy Mutator are responsible to generate and mutate the inputs under the guidance from the Decoder Guider; the OpenFlow Proxy is used to transmit the messages between the controllers and switches; the Difference Analyzer collects and analyzes the outputs of the controllers under the same input.

## Project Structure

DiffController is built using Python3 and is structured as follows:

```
├── build
├── capture
├── DecoderGuider
├── DifferenceAnalyzer
├── DifferenceStrategies
├── generation
├── log
├── networkcontrol
├── ofproto
├── OpenFlowProxy
├── pyloxi3
├── RestAPP
├── topology
├── DiffController.py
├── README.md
└── requirements.txt
```

-   `DiffController.py`: Main file for DiffController.
-   `build`: Builds docker images of the SDN controller (Floodlight, ONOS, Ryu, and OpenDaylight).
-   `DecoderGuider`: Contains Decoder modules of different controllers and uses the Decoder module to parse OpenFlow packet sequences.
-   `DifferenceAnalyzer`: Analyzes the differences in the behavior of different controllers.
-   `DifferenceStrategies`: Saves the output of Diffcontroller, namely the strategies that can lead to differences in controller behavior.
-   `generation`: Includes strategy generation, mutation, and evolution.
-   `networkcontrol`: Starts the controllers as well as controls Mininet to build the network.
-   `OpenFlowProxy`: Transits OpenFlow messages between the data plane and the control plane.
-   `pyloxi3`: OpenFlow python parsing library automatically generated by LoxiGen.
-   `RestAPP`: Collects controller behavior through northbound APIs.
-   `topology`: Includes different network topologies and scripts for converting dot files into Mininet custom topologies.
-   `README.md`: Documentation for Diffcontroller.
-   `requirements.txt`: List of required Python packages.

## Installation and Usage

### Requirements

-   Python 3.x
-   dictdiffer==0.9.0
-   interval3==2.0.0
-   JPype1==1.4.1
-   mininet==2.3.0.dev6
-   networkx==2.7.1
-   Requests==2.31.0
-   ryu==4.34
-   scapy==2.4.3

### Installation

To install DiffController, follow these steps:

1.  Clone the DiffController repository from GitHub:

```
git clone https://github.com/DiffController/DiffController.git
```

1.  Navigate to the `DiffController` directory:

```
    cd DiffController
```

2.  Install the required Python packages:

```
    pip install -r requirements.txt
```
3.  Build docker containers with different controllers, refer to `ControllerDockerBuild.md` in the /build directory

### Usage

To use DiffController, follow these steps:

1.  Run the SDN controllers in the Docker. For example, run Ryu as follows:

``` 
    cd networkcontrol
    sudo ./run_ryu.sh
```

2.  Run `OFProxyHandler.py` to constantly sending strategies in the strategy queue to perform tests. The -o parameter indicates the file where the final output strategy will be saved.

``` 
    cd generation
    python3 OFProxyHandler.py -o differences_strategy.txt
```

3. Run `DiffController.py` for differential testing of different controllers.
```
   sudo python3 DiffController.py --log_file log/ofcapture.log
```

4.  To stop DiffController, press `CTRL+C`.







